{% extends 'base.html' %}

{% import 'components/header_with_button.html' as section_header %}
{% import 'finance_manager/header_bar.html' as finance_header %}

{% block title %}Event Details - Finance Manager{% endblock %} 

{% block extra_css %}
  <link rel="stylesheet" href="{{url_for('static', filename='css/common.css')}}">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/eventcard.css') }}">
{% endblock %} 
    
{% block header %}
{{ finance_header.finance_header(user_id) }}
{% endblock %}

{% block content %}
<h3>Event Financial Overview</h3>

<div class="event-details-card card mb-4">
  <div class="card-body">
    <h4 class="card-title">Event Details</h4>
    <p><strong>Event:</strong> {{ event_details.name }}</p>
    <p><strong>Date:</strong> {{ event_details.date }}</p>
    <p><strong>Department:</strong> {{ event_details.department }}</p>
    <p><strong>Event Type:</strong> {{ event_details.event_type }}</p>
    <p><strong>Finance Manager:</strong> {{ event_details.finance_manager }}</p>
    <p><strong>Event Manager:</strong> {{ event_details.event_manager }}</p>

    <a href="{{ url_for('finance_manager.event_visualization',event_id=event_details.id, user_id=user_id) }}" class="btn btn-primary">Visualize Event Data</a>
  </div>
</div>

{% if revenue > 0 or expenses > 0 %}
<div class="financial-summary card mb-4">
  <div class="card-body">
    <h4 class="card-title">Revenue and Expenses</h4>
    {% if revenue > 0 %}
    <p><strong>Revenue:</strong> ₹{{ revenue }}</p>
    {% endif %}
    {% if expenses > 0 %}
    <p><strong>Expenses:</strong> ₹{{ expenses }}</p>
    {% endif %}
  </div>
</div>
{% endif %}

{% if category_totals %}
<div class="category-totals card mb-4">
  <div class="card-body">
    <h4 class="card-title">Totals by Transaction Category</h4>
    <table class="table table-bordered">
      <thead>
        <tr>
          <th>Category Name</th>
          <th>Total Amount (₹)</th>
        </tr>
      </thead>
      <tbody>
        {% for category_name, total in category_totals.items() %}
          {% if total > 0 %}
          <tr>
            <td>{{ category_name }}</td>
            <td>₹{{ total }}</td>
          </tr>
          {% endif %}
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endif %}

{% if mode_totals %}
<div class="payment-mode-totals card mb-4">
  <div class="card-body">
    <h4 class="card-title">Totals by Payment Mode</h4>
    <table class="table table-bordered">
      <thead>
        <tr>
          <th>Payment Mode</th>
          <th>Total Amount (₹)</th>
        </tr>
      </thead>
      <tbody>
        {% for mode_name, total in mode_totals.items() %}
          {% if total > 0 %}
          <tr>
            <td>{{ mode_name }}</td>
            <td>₹{{ total }}</td>
          </tr>
          {% endif %}
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endif %}

{% endblock %}

